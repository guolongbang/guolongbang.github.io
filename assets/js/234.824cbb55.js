(window.webpackJsonp=window.webpackJsonp||[]).push([[234],{559:function(t,s,a){"use strict";a.r(s);var e=a(7),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"webgl渲染管线"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webgl渲染管线"}},[t._v("#")]),t._v(" WebGL渲染管线")]),t._v(" "),s("p",[t._v("本节课主要是结合前面写过的"),s("code",[t._v("ShaderMaterial")]),t._v("代码，科普下"),s("strong",[t._v("WebGL渲染管线")]),t._v("概念，这样有助于后续的课程学习，你跟着视频过一遍就行，如果你有些名词概念你比较陌生，也不用深究，先大概有个印象。")]),t._v(" "),s("h3",{attrs:{id:"知识回顾-三角形和几何体顶点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#知识回顾-三角形和几何体顶点"}},[t._v("#")]),t._v(" 知识回顾：三角形和几何体顶点")]),t._v(" "),s("p",[t._v("你可以回顾下，基础课程中"),s("a",{attrs:{href:"http://www.webgl3d.cn/pages/f84ca8/",target:"_blank",rel:"noopener noreferrer"}},[t._v("章节2关于BufferGeometry"),s("OutboundLink")],1),t._v("的知识点。网格模型是由"),s("a",{attrs:{href:"http://www.webgl3d.cn/pages/32785a/",target:"_blank",rel:"noopener noreferrer"}},[t._v("三角形"),s("OutboundLink")],1),t._v("拼接而成，每个三角形包含三个顶点，这些三角形顶点的数据包含在Mesh对应的几何体中"),s("code",[t._v("BufferGeometry")])]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E4%B8%89%E8%A7%92%E5%BD%A2.jpg",alt:""}})]),t._v(" "),s("p",[t._v("课件演示文件中直接使用的threejs自带矩形平面几何体。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" geometry "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PlaneGeometry")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("然后你自己做一个练习，把演示文件中"),s("code",[t._v("PlaneGeometry")]),t._v("替换为你自定义顶点的矩形平面,加深下印象，Mesh一般通过三角形组成，三角形有自己顶点坐标。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" geometry "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BufferGeometry")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建一个几何体对象")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//类型数组创建顶点数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vertices "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Float32Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 三角形1顶点坐标")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//顶点1坐标")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//顶点2坐标")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//顶点3坐标")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 三角形2顶点坐标")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//顶点4坐标   和顶点1位置相同")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//顶点5坐标  和顶点3位置相同")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//顶点6坐标")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" attribute "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BufferAttribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vertices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3个为一组，表示一个顶点的xyz坐标")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置几何体顶点位置.attributes.position")]),t._v("\ngeometry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attributes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("position "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" attribute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"显卡gpu-执行着色器代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#显卡gpu-执行着色器代码"}},[t._v("#")]),t._v(" 显卡GPU：执行着色器代码")]),t._v(" "),s("p",[t._v("你稍微有点电脑常识，应该都知道电脑除了CPU处理器，还有一个"),s("a",{attrs:{href:"https://baike.baidu.com/item/%E5%9B%BE%E5%BD%A2%E5%A4%84%E7%90%86%E5%99%A8/8694767?fromtitle=gpu&fromid=105524",target:"_blank",rel:"noopener noreferrer"}},[t._v("GPU图形处理器"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("你平时写的JavaScript代码会在CPU上执行，而你写的"),s("strong",[t._v("着色器GLSL ES代码")]),t._v("是在你显卡的GPU上执行。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E6%98%BE%E5%8D%A1GPU%E6%89%A7%E8%A1%8C%E7%9D%80%E8%89%B2%E5%99%A8%E4%BB%A3%E7%A0%81.jpg",alt:""}})]),t._v(" "),s("p",[t._v("也就是3D渲染依赖于你电脑上的显卡GPU，一般来说，你渲染的3D场景越复杂，对显卡要求越高，比如一些大场景的物联网、数字孪生项目，往往需要配置一个比较好的独立显卡。")]),t._v(" "),s("h3",{attrs:{id:"显卡内存-显存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#显卡内存-显存"}},[t._v("#")]),t._v(" 显卡内存(显存)")]),t._v(" "),s("p",[t._v("你电脑上显卡除了GPU，还有GPU对应的内存，也就是显存，在显卡GPU渲染3D场景的时候，会把相关的顶点、纹理图像等数据存储在显存上。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E6%98%BE%E5%8D%A1%E7%9A%84%E6%98%BE%E5%AD%98%E5%92%8CGPU%E7%BB%84%E6%88%90.jpg",alt:""}})]),t._v(" "),s("p",[t._v("你在购买显卡的时候，一般会看到商品标注的"),s("strong",[t._v("显存容量")]),t._v("参数。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E6%98%BE%E5%AD%98%E5%AE%B9%E9%87%8F%E5%8F%82%E6%95%B0.jpg",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"webgl渲染管线-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webgl渲染管线-2"}},[t._v("#")]),t._v(" WebGL渲染管线")]),t._v(" "),s("p",[t._v("如果你有WebGL基础，对WebGL"),s("strong",[t._v("渲染管线")]),t._v("肯定不陌生，当然你不了解WebGL也没关系，咱们会后续课程会结合threejs代码给你从零介绍WebGL渲染管线。")]),t._v(" "),s("p",[t._v("你可以把WebGL"),s("strong",[t._v("渲染管线")]),t._v("想象为你显卡上的一条工厂流水线，工厂流水线有不同的工位，渲染管线也是如此，渲染管线上有多个不同的功能单元。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E6%98%BE%E5%8D%A1WebGL%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF.jpg",alt:""}})]),t._v(" "),s("p",[t._v("提醒：渲染管线内容比较多，本节课跟着下面内容，先了解渲染管线小部分功能单元即可，不用全部记住。")]),t._v(" "),s("h3",{attrs:{id:"shadermaterial代码执行过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#shadermaterial代码执行过程"}},[t._v("#")]),t._v(" "),s("code",[t._v("ShaderMaterial")]),t._v("代码执行过程")]),t._v(" "),s("p",[t._v("这是前面咱们经常写的"),s("code",[t._v("ShaderMaterial")]),t._v("代码。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 顶点着色器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vertexShader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\nvoid main(){\n  // 投影矩阵 * 模型视图矩阵 * 模型顶点坐标\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\n}\n")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 片元着色器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fragmentShader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\nvoid main() {\n    gl_FragColor = vec4(0.0,1.0,1.0,1.0);\n}\n")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" material "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShaderMaterial")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("vertexShader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" vertexShader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 顶点着色器")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("fragmentShader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" fragmentShader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 片元着色器")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mesh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mesh")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("geometry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" material"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" mesh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("当threejs通过WebGL渲染器"),s("code",[t._v("WebGLRenderer")]),t._v("渲染的时候，会做下面几件事：")]),t._v(" "),s("ol",[s("li",[t._v("从几何体"),s("code",[t._v("BufferGeometry")]),t._v("中获取顶点数据，把这些顶点数据存入显存上创建的"),s("strong",[t._v("顶点缓冲区")]),t._v("。")]),t._v(" "),s("li",[s("strong",[t._v("顶点着色器")]),t._v("功能单元，会执行顶点着色器GLSL ES代码，对这些顶点进行几何体变换(旋转、缩放、平移)")]),t._v(" "),s("li",[s("strong",[t._v("片元着色器")]),t._v("功能单元，会执行片元着色器GLSL ES代码，设置颜色值。")])]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/shader%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%8E%AF%E8%8A%82.jpg",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"webgl渲染管线执行过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webgl渲染管线执行过程"}},[t._v("#")]),t._v(" WebGL渲染管线执行过程")]),t._v(" "),s("p",[t._v("下面给大家详细说明下，顶点着色器到片元着色器的处理可成。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E5%9B%BE%E5%85%83%E8%A3%85%E9%85%8D%E5%85%89%E6%A0%85%E5%8C%96.png",alt:""}})]),t._v(" "),s("ol",[s("li",[t._v("顶点缓冲区：顶点数据")]),t._v(" "),s("li",[t._v("顶点着色器：顶点变换")]),t._v(" "),s("li",[t._v("图元装配：比如渲染Mesh，Mesh几何体有多个三角形拼接，三个点为一组生成一个三角形")]),t._v(" "),s("li",[t._v("光栅化：比如在上一步三角形轮廓中，生成填充一个一个片元(像素)")]),t._v(" "),s("li",[t._v("片元着色器：给片元(像素)着色器")])]),t._v(" "),s("h3",{attrs:{id:"顶点着色器-逐顶点概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#顶点着色器-逐顶点概念"}},[t._v("#")]),t._v(" 顶点着色器：逐顶点概念")]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E9%A1%B6%E7%82%B9%E7%9D%80%E8%89%B2%E5%99%A8%E5%8A%9F%E8%83%BD.png",alt:""}})]),t._v(" "),s("p",[t._v("渲染管线上顶点着色器的功能就是执行"),s("strong",[t._v("顶点着色器")]),t._v("代码,根据你写的代码对几何体顶点数据进行处理。比如本节课案例源码，就是通过矩阵对顶点进行几何体变换(平移、旋转、缩放)。")]),t._v(" "),s("p",[t._v("这个过程是逐顶点操作的，你把每个顶点数据想象成流水线上的一个一个零件，每个顶点经过顶点着色器功能单元时候，都会倍顶点着色器处理，比如几何变换。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 顶点着色器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vertexShader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\nvoid main(){\n  // 对每个顶点坐标进行矩阵变换\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\n}\n")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n")])])]),s("h3",{attrs:{id:"图元装配、光栅化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图元装配、光栅化"}},[t._v("#")]),t._v(" 图元装配、光栅化")]),t._v(" "),s("p",[t._v("经过顶点着色器处理的顶点数据，会进入WebGL渲染管线下一个环节，也就是"),s("strong",[t._v("图元装配")]),t._v("，比如渲染Mesh，"),s("strong",[t._v("图元装配")]),t._v("时候，就会把三个点为一组生成一个三角形轮廓，接着就是"),s("strong",[t._v("光栅化")]),t._v("，在上一步三角形轮廓内生成一个个片元，填充三角形轮廓，你可以暂时把片元理解为像素点。"),s("strong",[t._v("光栅化")]),t._v("其实相当于在几何图形轮廓内，生成一个个密集排列的片元(像素)。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E5%9B%BE%E5%85%83%E8%A3%85%E9%85%8D%E5%85%89%E6%A0%85%E5%8C%96.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"片元着色器-逐片元概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#片元着色器-逐片元概念"}},[t._v("#")]),t._v(" 片元着色器：逐片元概念")]),t._v(" "),s("p",[t._v("经过图元装配、光栅化，会生成一个一个片元，"),s("strong",[t._v("片元着色器")]),t._v("的作用就是执行片元着色器代码，按照片元着色器代码，给所有片元上色，也就是设置片元的像素值。每个片元经过渲染管线上的片元着色器都会按照GLSL ES代码规则设置颜色值，下节课会给大家演示更多上色规则。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/imgthreejs/%E5%9B%BE%E5%85%83%E8%A3%85%E9%85%8D%E5%85%89%E6%A0%85%E5%8C%96.png",alt:""}})]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 片元着色器代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fragmentShader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\nvoid main() {\n    // 给每个片元设置颜色\n    gl_FragColor = vec4(0.0,1.0,1.0,1.0);\n}\n")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);