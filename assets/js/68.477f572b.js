(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{394:function(t,n,s){"use strict";s.r(n);var a=s(7),e=Object(a.a)({},(function(){var t=this,n=t._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"纹理-encoding和渲染器-outputencoding"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#纹理-encoding和渲染器-outputencoding"}},[t._v("#")]),t._v(" 纹理"),n("code",[t._v(".encoding")]),t._v("和渲染器"),n("code",[t._v(".outputEncoding")])]),t._v(" "),n("p",[t._v("如果没有特殊需要，一般为了正常渲染，避免颜色偏差，threejs代码中需要颜色贴图"),n("code",[t._v(".encoding")]),t._v("和渲染器"),n("code",[t._v(".outputEncoding")]),t._v("属性值保持一致。")]),t._v(" "),n("h3",{attrs:{id:"纹理对象texture颜色空间编码属性-encoding"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#纹理对象texture颜色空间编码属性-encoding"}},[t._v("#")]),t._v(" 纹理对象"),n("code",[t._v("Texture")]),t._v("颜色空间编码属性"),n("code",[t._v(".encoding")])]),t._v(" "),n("p",[t._v("纹理对象Texture"),n("a",{attrs:{href:"https://baike.baidu.com/item/%E9%A2%9C%E8%89%B2%E7%A9%BA%E9%97%B4/10834848?fr=aladdin",target:"_blank",rel:"noopener noreferrer"}},[t._v("颜色空间"),n("OutboundLink")],1),t._v("编码属性"),n("code",[t._v(".encoding")]),t._v("有多个属性值，默认值是线性颜色空间"),n("code",[t._v("THREE.LinearEncoding")]),t._v("。")]),t._v(" "),n("ul",[n("li",[t._v("THREE.LinearEncoding：线性颜色空间")]),t._v(" "),n("li",[t._v("THREE.sRGBEncoding："),n("a",{attrs:{href:"https://baike.baidu.com/item/sRGB/1350619?fr=aladdin",target:"_blank",rel:"noopener noreferrer"}},[t._v("sRGB"),n("OutboundLink")],1),t._v("颜色空间")])]),t._v(" "),n("h3",{attrs:{id:"浏览器控制台查看texture-encoding属性值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#浏览器控制台查看texture-encoding属性值"}},[t._v("#")]),t._v(" 浏览器控制台查看"),n("code",[t._v("Texture.encoding")]),t._v("属性值")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" texture "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TextureLoader")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("load")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./earth.jpg'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ntexture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LinearEncoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//默认值")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// THREE.LinearEncoding变量在threejs内部表示数字3000")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'texture.encoding'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("texture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改为THREE.sRGBEncoding，")]),t._v("\ntexture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sRGBEncoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// THREE.sRGBEncoding变量在threejs内部表示数字3001")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'texture.encoding'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("texture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("code",[t._v("THREE.LinearEncoding")]),t._v("、"),n("code",[t._v("THREE.sRGBEncoding")]),t._v("其实在theeejs内部都表示一个数字,具体可以查看src目录下constants.js的源码文件。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// constants.js源码部分截取")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" LinearEncoding "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" sRGBEncoding "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3001")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"gltfmap-encoding值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gltfmap-encoding值"}},[t._v("#")]),t._v(" gltf"),n("code",[t._v("map.encoding")]),t._v("值")]),t._v(" "),n("p",[t._v("threejs加载gltf模型，颜色贴图"),n("code",[t._v("map")]),t._v("属性"),n("code",[t._v(".encoding")]),t._v("的默认值是sRGB颜色空间"),n("code",[t._v("THREE.sRGBEncoding")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查看gltf所有颜色贴图的.encoding值")]),t._v("\ngltf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scene"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("traverse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isMesh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("material"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("map"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//判断是否存在贴图")]),t._v("\n            console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.encoding'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("material"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("map"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .encoding显示3001，说明是THREE.sRGBEncoding")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.encoding'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("mesh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("material"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("map"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"webgl渲染器-outputencoding"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webgl渲染器-outputencoding"}},[t._v("#")]),t._v(" WebGL渲染器"),n("code",[t._v(".outputEncoding")])]),t._v(" "),n("p",[n("code",[t._v(".outputEncoding")]),t._v("的默认值是线性空间"),n("code",[t._v("THREE.LinearEncoding")]),t._v(",和纹理对象"),n("code",[t._v(".encoding")]),t._v("默认值一样，如果颜色贴图"),n("code",[t._v(".encoding")]),t._v("的值是"),n("code",[t._v("THREE.sRGBEncoding")]),t._v("，为了避免颜色偏差，"),n("code",[t._v(".outputEncoding")]),t._v("的值也需要设置为"),n("code",[t._v("THREE.sRGBEncoding")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//解决加载gltf格式模型颜色偏差问题")]),t._v("\nrenderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("outputEncoding "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sRGBEncoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("注意！最新版本属性名字有改变。渲染器属性名"),n("code",[t._v(".outputEncoding")]),t._v("已经变更为"),n("code",[t._v(".outputColorSpace")]),t._v("，具体参考6.3小节最后说明。")]),t._v(" "),n("h3",{attrs:{id:"单独加载的颜色贴图设置-encoding-three-srgbencoding"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单独加载的颜色贴图设置-encoding-three-srgbencoding"}},[t._v("#")]),t._v(" 单独加载的颜色贴图设置"),n("code",[t._v(".encoding = THREE.sRGBEncoding")])]),t._v(" "),n("p",[t._v("如果webgl渲染器设置了"),n("code",[t._v("renderer.outputEncoding = THREE.sRGBEncoding;")]),t._v(",你单独加载图像返回的纹理对象需要设置\n"),n("code",[t._v("texture.encoding = THREE.sRGBEncoding;")])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//解决加载gltf格式模型颜色偏差问题")]),t._v("\nrenderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("outputEncoding "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sRGBEncoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" texture "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TextureLoader")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("load")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./earth.jpg'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 和webgl渲染器renderer.outputEncoding一致")]),t._v("\ntexture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sRGBEncoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("注意！！！最新版本，纹理对象属性名"),n("code",[t._v(".encoding")]),t._v("已经变更为"),n("code",[t._v(".colorSpace")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("texture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("colorSpace  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("THREE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SRGBColorSpace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置为SRGB颜色空间")]),t._v("\n")])])])])}),[],!1,null,null,null);n.default=e.exports}}]);